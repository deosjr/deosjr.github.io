<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="reflect.js"></script>
    <script type="text/javascript" src="dynamicland.js"></script>
    <link rel="stylesheet" href="style.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <body>
    <main>
    <p id="wasm-error" hidden="true">
      A browser with Wasm GC and tail call support is required for
      this demo.  We recommend using either Mozilla Firefox or Google
      Chrome.
    </p>
    <h2>Adventures in Dynamicland</h2>
    <div class=img-crop>
      <img src="https://i.imgur.com/WCRBWNa.jpeg">
    </div>
    <p>This page runs on Scheme->WebAssembly using <a href="https://spritely.institute/hoot/">Hoot</a>.
	It implements a reverse-engineered RealTalk, the logic engine behind Bret Victor's <a href="https://dynamicland.org/">Dynamicland</a>.
	The purpose of this page is to document the implementation for people like me who want to build their own.</p>
    <p>Notably this page goes against some of the design principles of Dynamicland: it is not intended to be a replacement in any way.
	But Dynamicland is not publicly available, and Oakland is pretty far away.
	So with apologies to Bret, let's have a look at RealTalk as I've reverse engineered it and explore some of its concepts.</p>
    <p>Here are two pages. Their associated code is shown below.</p>
    <h3>Page 1:</h3>
    <div class=code>(Claim this 'highlighted "red")</div>
    <h3>Page 2:</h3>
    <div class=code>
  (When ((highlighted ,?p ,?color)
         ((page left) ,this ,?thisleft)
         ((page left) ,?p ,?thatleft))
   do (if (and (< ?thisleft ?thatleft)
               (< 100 (- ?thatleft ?thisleft)))
        (set-background! (get-page ?p) ?color))))))
    </div>
    <p>Meaning, page 1 asserts a claim: it should be highlighted red!
       Page 2 introduces a rule: if a page claims to be a certain color, then set its background to that color, but only if that page is more than 100px to the right of page 2.
       Pages only exist if they are contained within the bounds of the table, and can only assert claims/rules for as long as they exist.</p>
    <div id=pages class="pages"></div>
    <p>Try dragging the pages above onto the table below!</p>
    <p id=table class="table"></p>
    <p>Instead of paper pages, this page uses HTML divs.
       I will use them to illustrate some of RealTalk's behaviour as we build it up.
       Each page is associated with some code that is active when the page is contained within the table div.
       Follow the links below to learn how all of this works: I promise it is more interesting than 'if both pages are on the table, colour one of them red'.</p>
    <nav>
    <h2>Table of Contents</h2>
    <ul>
    <li><a href="/dynamicland/todo.html">Webcams, projectors and scripting languages (todo)</a></li>
    <li><a href="/dynamicland/todo.html">Datalog in Minikanren (todo)</a></li>
    <li><a href="/dynamicland/todo.html">RealTalk: hacking Datalog (todo)</a>
      <ul>
        <li><a href="/dynamicland/todo.html">A naive first approximation (todo)</a></li>
        <li><a href="/dynamicland/todo.html">Page persistence and variable scoping(todo)</a></li>
      </ul>
    </li>
    </ul>
    </nav>
    </main>
  </body>
</html>
